<Window x:Class="AODamageMeter.UI.Views.DamageMeterView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:fa="http://schemas.fontawesome.io/icons/"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:viewModels="clr-namespace:AODamageMeter.UI.ViewModels"
        xmlns:rowViews="clr-namespace:AODamageMeter.UI.Views.Rows"
        xmlns:scm="clr-namespace:System.ComponentModel;assembly=WindowsBase"
        xmlns:clr="clr-namespace:System;assembly=mscorlib"
        mc:Ignorable="d" d:DataContext="{d:DesignInstance viewModels:DamageMeterViewModel}"
        Title="Anarchy Online Damage Meter"
        ResizeMode="CanResizeWithGrip" WindowStyle="None" Topmost="True"
        AllowsTransparency="True" Background="Transparent"
        Height="200" Width="300">
  <Window.Resources>
    <Style TargetType="Button">
      <Setter Property="Background" Value="Transparent"/>
      <Setter Property="BorderBrush" Value="Transparent"/>
    </Style>

    <Style TargetType="fa:ImageAwesome">
      <Setter Property="Foreground" Value="#73CBD3"/>
      <Setter Property="Margin" Value="3.5"/>
    </Style>

    <Style TargetType="DataGridCell">
      <Setter Property="Padding" Value="0"/>
      <Setter Property="BorderThickness" Value="0"/>
    </Style>

    <CollectionViewSource x:Key="DamageDoneRowsViewSource" Source="{Binding DamageDoneRows}" IsLiveSortingRequested="True">
      <CollectionViewSource.LiveSortingProperties>
        <clr:String>PercentWidth</clr:String>
      </CollectionViewSource.LiveSortingProperties>
      <CollectionViewSource.SortDescriptions>
        <scm:SortDescription PropertyName="PercentWidth" Direction="Descending"/>
      </CollectionViewSource.SortDescriptions>
    </CollectionViewSource>
  </Window.Resources>

  <Grid Background="Transparent">
    <Grid.RowDefinitions>
      <RowDefinition Height="25"/>
      <RowDefinition Height="*"/>
    </Grid.RowDefinitions>

    <Grid Grid.Row="0"
          MouseDown="HeaderRow_MouseDown_Drag"
          Background="#0C1E2F">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="27"/>
        <ColumnDefinition Width="*"/>
        <ColumnDefinition Width="27"/>
        <ColumnDefinition Width="27"/>
        <ColumnDefinition Width="27"/>
      </Grid.ColumnDefinitions>

      <Button Grid.Column="0" x:Name="FileButton"
              Click="FileButton_Click_SetLogFile">
        <fa:ImageAwesome Icon="FileTextOutline"/>
      </Button>

      <!--<Button Grid.Column="2"
              Command="{Binding Options}">
        <fa:ImageAwesome Icon="Gear"/>
      </Button>-->

      <Button Grid.Column="3"
              Command="{Binding ResetDamageMeterCommand}">
        <fa:ImageAwesome Icon="Refresh"/>
      </Button>

      <Button Grid.Column="4" x:Name="CloseButton"
              Click="CloseButton_Click_CloseApplication">
        <fa:ImageAwesome Icon="Close"/>
      </Button>
    </Grid>

    <!-- Tried briefly to use something simpler like a ListBox, but had difficulty getting the styling to be as tight. -->
    <DataGrid Grid.Row="1" x:Name="DamageMeter"
              ItemsSource="{Binding Source={StaticResource DamageDoneRowsViewSource}}"
              IsReadOnly="True" AutoGenerateColumns="False"
              VerticalScrollBarVisibility="Disabled" HorizontalScrollBarVisibility="Disabled"
              HeadersVisibility="None" GridLinesVisibility="None" RowBackground="Transparent">
      <DataGrid.Background>
        <SolidColorBrush Color="Black" Opacity="0.4"/>
      </DataGrid.Background>

      <DataGrid.Columns>
        <DataGridTemplateColumn Width="*">
          <DataGridTemplateColumn.CellTemplate>
            <DataTemplate>
              <rowViews:DamageDoneRowView/>
            </DataTemplate>
          </DataGridTemplateColumn.CellTemplate>
        </DataGridTemplateColumn>
      </DataGrid.Columns>
    </DataGrid>
  </Grid>
</Window>
